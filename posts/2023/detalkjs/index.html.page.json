{"title":"Detalk.js —— 具有高自定义性、简洁、轻量的开源评论系统 - YFun's Blog","path":"/posts/2023/detalkjs/index.html","extraJS":["function loadComment(){try{loadScriptFile({url:\"https://cdn.jsdelivr.net/npm/@detalk/static@2/dist/detalk.js\",loadType:\"async\",cb:()=>{detalk.init({url:\"https://detalk-blog.deta.dev\",el:\"#detalk\",label:{admin:{name:\"博主\",class:\"label-green\"}},recaptchaSiteKey:\"6Leg6eAjAAAAACRSX8vHaSK3e5K_zTSEKoJu29BR\",login:{github:\"781d0cee7073a7ca974a\"},owo:\"https://owo.imaegoo.com/owo.json\"})}})}catch(e){document.getElementById(\"loadCommentBtn\").innerText=\"无法加载 Detalk.js 评论\",console.info(e)}}function loadDetalk(){try{loadComment()}catch(e){console.log(e)}}var runningOnBrowser=\"undefined\"!=typeof window,isBot=runningOnBrowser&&!(\"onscroll\"in window)||\"undefined\"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),supportsIntersectionObserver=runningOnBrowser&&\"IntersectionObserver\"in window;setTimeout(function(){var n;!isBot&&supportsIntersectionObserver?(n=new IntersectionObserver(function(e){e[0].isIntersecting&&(loadDetalk(),n.disconnect())},{threshold:[0]})).observe(document.getElementById(\"miracle-comments\")):loadDetalk()},1)","var postImg=document.querySelectorAll(\"article[class=page] img\");for(let t=0;t<postImg.length;t++)postImg[t].onclick=()=>{var i=document.createElement(\"div\");i.id=\"zoomImg\",i.innerHTML=`<div id=\"zoom-picture\"></div>\n    <div class=\"poptrox-overlay\"\n        style=\"position: fixed; left: 0px; top: 0px; z-index: 20000; width: 100%; height: 100%; text-align: center; cursor: zoom-out; opacity: 1;\">\n        <div style=\"display:inline-block;height:100%;vertical-align:middle;\"></div>\n        <div\n            style=\"position:absolute;left:0;top:0;width:100%;height:100%;background:#000000;opacity:0;filter:alpha(opacity=0);\">\n        </div>\n        <div class=\"poptrox-popup\"\n            style=\"display: inline-block; vertical-align: middle; position: relative; z-index: 1; cursor: zoom-out; min-width: 10px; min-height: 10px; width: auto; height: auto;\">\n            <div class=\"loader\" style=\"display: none;\"></div>\n            <div class=\"pic\" style=\"text-indent: 0px;\"><img\n                    src=\"${postImg[t].srcset||postImg[t].src}\" alt=\"Loading...\"\n                    style=\"vertical-align: bottom; max-width: 85vw; max-height: 85vh;\"></div>\n        </div>\n    </div>`,document.body.appendChild(i),document.querySelector(\"#zoomImg\").onclick=()=>{document.querySelector(\"#zoomImg\").remove()}}","try{var io=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&((e=e.target).srcset=e.getAttribute(\"data-srcset\"),e.className+=\" loaded\",io.unobserve(e))})})}catch(e){console.info(e)}query(\".lazyload-img\").forEach(function(e){try{io.observe(e)}catch(e){console.info(e)}})","query(\"#toc-btn\")[0].onclick=()=>{query(\".post-toc\")[0].innerHTML&&toggleClass(\".post-toc\",\"display-inline\")},query(\".post-toc\")[0].innerHTML||addClass(\"#toc-btn\",\"display-none\")","query(\"#share-btn\")[0].onclick=async()=>{var t=`${location.protocol}//${location.hostname}${location.port&&\":\"+location.port}${location.pathname}#read=`+(sessionStorage.getItem(location.pathname+\"_read_y\")||\"\");try{await navigator.clipboard.writeText(t),prompt_core(\"分享链接已经复制至剪贴板\",4800,!0)}catch(o){prompt_core(\"分享链接复制失败，请手动复制<br/>\"+t,4800,!1)}}","const getScrollPosition=(e=window)=>({x:void 0!==e.pageXOffset?e.pageXOffset:e.scrollLeft,y:void 0!==e.pageYOffset?e.pageYOffset:e.scrollTop});var wx=document.getElementsByClassName(\"article-m\")[0].clientWidth,wy=document.getElementsByClassName(\"article-m\")[0].clientHeight;function windowScroll(){wx=document.getElementsByClassName(\"article-m\")[0].clientWidth,wy=document.getElementsByClassName(\"article-m\")[0].clientHeight;var e=Math.round(getScrollPosition().y)+`:${wx}:`+wy;sessionStorage.setItem(location.pathname+\"_read_y\",e)}setTimeout(()=>{if(1<location.hash.split(\"#read=\").length){prompt_core(\"已有阅读进度，正在跳转\",4800,!0);let e=location.hash.split(\"#read=\")[1];e=e.split(\":\"),window.scrollTo({top:Math.round(Number(e[0])*Number(e[1]*Number(e[2]/wx/wy))),behavior:\"smooth\"})}else{let e=sessionStorage.getItem(location.pathname+\"_read_y\")||\"0:0:0\";\"0\"!=(e=e.split(\":\"))[0]&&prompt_core(\"已有阅读进度，正在跳转\",4800,!0),window.scrollTo({top:Math.round(Number(e[0])*Number(e[1]*Number(e[2]/wx/wy))),behavior:\"smooth\"})}},500),window.onscroll=windowScroll"],"page":"<div class=\"mg-top\"><article class=\"page\"><div id=\"post-meta-m\"><div class=\"post-meta\" id=\"post-meta\"><h3>Detalk.js —— 具有高自定义性、简洁、轻量的开源评论系统</h3><span class=\"post-meta-label\">YFun (@oCoke) </span><span class=\"post-meta-label\"><span class=\"p-dot\"></span> <time datetime=\"2023-01-10 00:00\" pubdate=\"\">2023-01-10 </time></span><span class=\"post-meta\"><span class=\"p-dot\"></span> 共 1.6k 字</span></div></div><div class=\"article-m\"><div class=\"post-toc\"><ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BC%80%E5%8F%91-Detalk-js\"><span class=\"toc-number\">1.</span> <span class=\"toc-text\">为什么开发 Detalk.js?</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%BC%80%E5%8F%91\"><span class=\"toc-number\">2.</span> <span class=\"toc-text\">服务端开发</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E5%BA%93\"><span class=\"toc-number\">2.1.</span> <span class=\"toc-text\">数据库</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#API\"><span class=\"toc-number\">2.2.</span> <span class=\"toc-text\">API</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91\"><span class=\"toc-number\">3.</span> <span class=\"toc-text\">前端开发</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%89%93%E5%8C%85\"><span class=\"toc-number\">3.1.</span> <span class=\"toc-text\">打包</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%89%8D%E7%AB%AF%E9%85%8D%E7%BD%AE%EF%BC%9F\"><span class=\"toc-number\">3.2.</span> <span class=\"toc-text\">前端配置？</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF\"><span class=\"toc-number\">4.</span> <span class=\"toc-text\">控制面板</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98\"><span class=\"toc-number\">5.</span> <span class=\"toc-text\">一些问题</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Markdown-%E8%A7%A3%E6%9E%90\"><span class=\"toc-number\">5.1.</span> <span class=\"toc-text\">Markdown 解析</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#URL-%E8%BD%BD%E5%85%A5%E9%85%8D%E7%BD%AE\"><span class=\"toc-number\">5.2.</span> <span class=\"toc-text\">URL 载入配置</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%A4%9A%E8%AF%AD%E8%A8%80%E7%9A%84%E5%AE%9E%E7%8E%B0\"><span class=\"toc-number\">5.3.</span> <span class=\"toc-text\">多语言的实现</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9C%80%E5%90%8E\"><span class=\"toc-number\">6.</span> <span class=\"toc-text\">最后</span></a></li></ol></div><div id=\"article\"><div id=\"post-content\" class=\"markdown-body textretty\"><h2 id=\"为什么开发-Detalk-js\"><a href=\"#为什么开发-Detalk-js\" class=\"headerlink\" title=\"为什么开发 Detalk.js?\"></a>为什么开发 Detalk.js?</h2><p>我一直在寻找开源、可以免费部署的评论系统，在 Valine 发现隐私问题和 XSS 漏洞后，我就放弃了 Valine 和「无后端」解决方案。</p><p>Waline 是「有后端的 Valine」，保留了 Valine 的很多特性，但还是没有让我满意。</p><p>后来，<a href=\"https://blog.yfun.top/posts/1987652759/#%E8%AF%84%E8%AE%BA\">我转到了 Twikoo</a>，这也是我使用最久的评论系统。它有非常丰富的特性，但我最后还是弃用了它。</p><p>Detalk.js 的部署平台从名字就可以看出，基于 Deta Bases 和 Deta Micros. 这些平台对个人开发者免费使用，非常的友好。</p><h2 id=\"服务端开发\"><a href=\"#服务端开发\" class=\"headerlink\" title=\"服务端开发\"></a>服务端开发</h2><p>Detalk.js 一开始就选择优先开发服务端，而前端则可以随意构建，有完整的服务端文档。</p><p>所以，我将主代码放到了 <a target=\"_blank\" rel=\"noopener\" href=\"https://github.com/detalkjs/server\">detalkjs/server</a> 中，得益于 Deta 平台，现在可以一键部署，稍等片刻就可以直接使用。</p><p>服务端我直接从官方的 Demo 开始写，使用官方推荐的 Express 框架，代码语言选择 JavaScript.</p><p>在开发过程中，我发现 Detalk.js 的响应时长至少在 1s+，我推测是与 Deta 平台的运行方案和冷启动有关，但对于评论系统来说，这无伤大雅。</p><h3 id=\"数据库\"><a href=\"#数据库\" class=\"headerlink\" title=\"数据库\"></a>数据库</h3><p>Deta 平台上，最方便的数据库就是 Deta Bases. 这又是一款 Key-Value 数据库，有着简单易于理解的 SDK 文档。</p><p>导入方法也很简单：</p><figure class=\"highlight js\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> { <span class=\"title class_\">Deta</span> } = <span class=\"built_in\">require</span>(<span class=\"string\">'deta'</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> deta = <span class=\"title class_\">Deta</span>();</span><br><span class=\"line\"><span class=\"comment\">// 为了方便用户部署多个 Detalk，用户可自定义 Base Name.</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> db = deta.<span class=\"title class_\">Base</span>(process.<span class=\"property\">env</span>.<span class=\"property\">BASE_NAME</span> || <span class=\"string\">'detalk'</span>);</span><br></pre></td></tr></tbody></table></figure><p>使用方法整体类似于 <a target=\"_blank\" rel=\"noopener\" href=\"https://github.com/yfun-lab/gh-worker-kv\">yfun-lab/gh-worker-kv</a>，对于部分代码的上手也是很简单的。</p><p>前往 Web 面板截图，可以看到，Detalk 所创建的数据库基本格式如下：</p><p><picture><source class=\"lazyload-img\" data-srcset=\"https://cdn.jsdelivr.net/npm/ocoke-osg@0.0.19/rawimg/ck31673269985711.webp\" srcset=\"data:image/gif;base64,R0lGODlhAQABAID/AP///wAAACwAAAAAAQABAAACAkQBADs\" type=\"image/webp\"><img webp-comp=\"\" src=\"https://cdn.jsdelivr.net/npm/ocoke-osg@0.0.19/rawimg/ck31673269985711.png\" class=\"lazyload-img\" data-srcset=\"https://cdn.jsdelivr.net/npm/ocoke-osg@0.0.19/rawimg/ck31673269985711.png\" srcset=\"data:image/gif;base64,R0lGODlhAQABAID/AP///wAAACwAAAAAAQABAAACAkQBADs\"></picture></p><p>以 <code>CMT_</code> 开头的存放评论，<code>FUNCTION_</code> 开头的存放事件函数，还有一些关于站点的配置。</p><h3 id=\"API\"><a href=\"#API\" class=\"headerlink\" title=\"API\"></a>API</h3><p>目前，所有后端的 API 都在 <a target=\"_blank\" rel=\"noopener\" href=\"https://detalk.js.org/server/api.html\">API | Detalk.js</a> 可以查看。</p><p>部分 API 需要鉴权登录操作，部分为公共 API，只需要后端地址即可调用。</p><h2 id=\"前端开发\"><a href=\"#前端开发\" class=\"headerlink\" title=\"前端开发\"></a>前端开发</h2><p>我对前端 <a target=\"_blank\" rel=\"noopener\" href=\"https://github.com/detalkjs/client\">detalkjs/client</a> 的简介是：</p><blockquote><p>⚡ The fastest way to add Detalk (Based on Deta) to your website. | 将 Detalk (Based on Deta) 加入你的网站。</p></blockquote><p>（这再次说明官方提供的前端只是一种方案，完全可以自己开发</p><p>也正因如此，前端的 NPM 包名是 <code>@detalk/static</code> （逃</p><h3 id=\"打包\"><a href=\"#打包\" class=\"headerlink\" title=\"打包\"></a>打包</h3><p>前端打包是 Webpack 5 方案，我多加了一个配置文件，可以打包出 JS, CSS 分离的版本。这样或许可以方便部分用户的引入需要。</p><p>但是从各方面来看，还是建议引入单 JS 的版本，大小约为 43kb，Gzip 压缩后约 12kb.</p><h3 id=\"前端配置？\"><a href=\"#前端配置？\" class=\"headerlink\" title=\"前端配置？\"></a>前端配置？</h3><p>设计前端时有两种读取配置文件的方案，一种是类似于 Twikoo，从服务端读取，另一种是直接在 <code>detalk.init</code> 时配置。</p><p>明显，前者需要多发送 1 - 2 次 HTTP 请求，加载速度也会变慢，所以我选择了后者。</p><h2 id=\"控制面板\"><a href=\"#控制面板\" class=\"headerlink\" title=\"控制面板\"></a>控制面板</h2><p>控制面板也可以使用完全 API 自构建，但是，我们提供了「依托答辩」的官方后端：<a target=\"_blank\" rel=\"noopener\" href=\"https://detalk-dash.netlify.app/\">https://detalk-dash.netlify.app/</a></p><p><del>除可维护角度以外，都挺好的（</del></p><h2 id=\"一些问题\"><a href=\"#一些问题\" class=\"headerlink\" title=\"一些问题\"></a>一些问题</h2><h3 id=\"Markdown-解析\"><a href=\"#Markdown-解析\" class=\"headerlink\" title=\"Markdown 解析\"></a>Markdown 解析</h3><p>如果你没有额外的配置，那么点击「预览」的时候。你肯定会发现需要等待一段时间。</p><p>我之前想把 Marked.js（号称轻量）的 Markdown 解析器加入 Detalk.js，结果发现包体积直接翻了一倍，于是放弃。</p><p>如果你需要更换解析器，不用担心，<a target=\"_blank\" rel=\"noopener\" href=\"https://detalk.js.org/client/advanced.html#%E8%87%AA%E5%AE%9A%E4%B9%89-markdown-%E9%A2%84%E8%A7%88\">这里</a>给出了方法。</p><h3 id=\"URL-载入配置\"><a href=\"#URL-载入配置\" class=\"headerlink\" title=\"URL 载入配置\"></a>URL 载入配置</h3><p>前文说到，Detalk 并没有采取后端配置的方法，但是，我们还是支持了从 URL 载入配置。</p><p>关于这一特性，可<a target=\"_blank\" rel=\"noopener\" href=\"https://detalk.js.org/client/advanced.html#beta-%E4%BB%8E-url-%E8%BD%BD%E5%85%A5%E9%85%8D%E7%BD%AE\">见此处</a>。</p><h3 id=\"多语言的实现\"><a href=\"#多语言的实现\" class=\"headerlink\" title=\"多语言的实现\"></a>多语言的实现</h3><p>Detalk.js 并没有默认提供多语言功能，这主要是因为不同站点的使用者受众不同，于是我决定这项功能可以由用户实现。</p><p>这依赖 <code>window.DETALK_I18N</code> 参数，如果没有此项，则会在 <code>detalk.init</code> 时由程序默认提供简体中文项。</p><p>实现代码可以见如下：</p><figure class=\"highlight js\"><table><tbody><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (navigator.<span class=\"property\">language</span> == <span class=\"string\">'zh-CN'</span>) {</span><br><span class=\"line\">  <span class=\"variable language_\">window</span>.<span class=\"property\">DETALK_I18N</span> = {</span><br><span class=\"line\">      <span class=\"attr\">loadMore</span>: <span class=\"string\">'加载更多'</span>,</span><br><span class=\"line\">      <span class=\"attr\">notAllowedInput</span>: <span class=\"string\">'输入内容不符合要求！'</span>,</span><br><span class=\"line\">      <span class=\"attr\">send</span>: <span class=\"string\">'发送'</span>,</span><br><span class=\"line\">      <span class=\"attr\">preview</span>: <span class=\"string\">'预览'</span>,</span><br><span class=\"line\">      <span class=\"attr\">reply</span>: <span class=\"string\">'回复'</span>,</span><br><span class=\"line\">      <span class=\"attr\">replyTo</span>: <span class=\"string\">'回复'</span>,</span><br><span class=\"line\">      <span class=\"attr\">cancel</span>: <span class=\"string\">'取消'</span>,</span><br><span class=\"line\">      <span class=\"attr\">loadingLoginFrame</span>: <span class=\"string\">'登录窗口加载中...'</span>,</span><br><span class=\"line\">      <span class=\"attr\">gotoLoginFrame</span>: <span class=\"string\">'请在登录窗口中继续'</span>,</span><br><span class=\"line\">      <span class=\"attr\">waitingInfo</span>: <span class=\"string\">'登录成功，正在获取用户信息...'</span>,</span><br><span class=\"line\">      <span class=\"attr\">loginSuccess</span>: <span class=\"string\">'登录成功'</span>,</span><br><span class=\"line\">      <span class=\"attr\">failedLoadingInfo</span>: <span class=\"string\">'获取用户信息失败'</span>,</span><br><span class=\"line\">      <span class=\"attr\">deleteConfirm</span>: <span class=\"string\">'即将删除 ID:[#ID] 评论，是否继续？'</span>,</span><br><span class=\"line\">      <span class=\"attr\">total</span>: <span class=\"string\">'共 [#TOTAL] 条评论'</span>,</span><br><span class=\"line\">      <span class=\"attr\">noComment</span>: <span class=\"string\">'暂无评论'</span>,</span><br><span class=\"line\">      <span class=\"attr\">up</span>: <span class=\"string\">'正序'</span>,</span><br><span class=\"line\">      <span class=\"attr\">down</span>: <span class=\"string\">'倒序'</span>,</span><br><span class=\"line\">      <span class=\"attr\">delete</span>: <span class=\"string\">'删除'</span>,</span><br><span class=\"line\">      <span class=\"attr\">top</span>: <span class=\"string\">'置顶'</span>,</span><br><span class=\"line\">      <span class=\"attr\">login</span>: <span class=\"string\">'登录'</span>,</span><br><span class=\"line\">      <span class=\"attr\">required</span>: <span class=\"string\">'必填'</span>,</span><br><span class=\"line\">      <span class=\"attr\">optional</span>: <span class=\"string\">'选填'</span>,</span><br><span class=\"line\">      <span class=\"attr\">nickname</span>: <span class=\"string\">'昵称'</span>,</span><br><span class=\"line\">      <span class=\"attr\">email</span>: <span class=\"string\">'邮箱'</span>,</span><br><span class=\"line\">      <span class=\"attr\">link</span>: <span class=\"string\">'网址'</span>,</span><br><span class=\"line\">      <span class=\"attr\">day</span>: {</span><br><span class=\"line\">      <span class=\"attr\">justNow</span>: <span class=\"string\">'刚刚'</span>,</span><br><span class=\"line\">      <span class=\"attr\">minute</span>: <span class=\"string\">'[#TIME] 分钟前'</span>,</span><br><span class=\"line\">      <span class=\"attr\">hour</span>: <span class=\"string\">'[#TIME] 小时前'</span>,</span><br><span class=\"line\">      <span class=\"attr\">day</span>: <span class=\"string\">'[#TIME] 天前'</span>,</span><br><span class=\"line\">  }</span><br><span class=\"line\">} <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (navigator.<span class=\"property\">language</span> == <span class=\"string\">'zh-TW'</span>) {</span><br><span class=\"line\">    <span class=\"variable language_\">window</span>.<span class=\"property\">DETALK_I18N</span> = {</span><br><span class=\"line\">      <span class=\"attr\">loadMore</span>: <span class=\"string\">'加載更多'</span>,</span><br><span class=\"line\">      <span class=\"attr\">notAllowedInput</span>: <span class=\"string\">'輸入內容不符合要求！'</span>,</span><br><span class=\"line\">      <span class=\"attr\">send</span>: <span class=\"string\">'發送'</span>,</span><br><span class=\"line\">      <span class=\"attr\">preview</span>: <span class=\"string\">'預覽'</span>,</span><br><span class=\"line\">      <span class=\"attr\">reply</span>: <span class=\"string\">'回复'</span>,</span><br><span class=\"line\">      <span class=\"attr\">replyTo</span>: <span class=\"string\">'回复'</span>,</span><br><span class=\"line\">      <span class=\"attr\">cancel</span>: <span class=\"string\">'取消'</span>,</span><br><span class=\"line\">      <span class=\"attr\">loadingLoginFrame</span>: <span class=\"string\">'登錄窗口加載中...'</span>,</span><br><span class=\"line\">      <span class=\"attr\">gotoLoginFrame</span>: <span class=\"string\">'請在登錄窗口中繼續'</span>,</span><br><span class=\"line\">      <span class=\"attr\">waitingInfo</span>: <span class=\"string\">'登錄成功，正在獲取用戶信息...'</span>,</span><br><span class=\"line\">      <span class=\"attr\">loginSuccess</span>: <span class=\"string\">'登錄成功'</span>,</span><br><span class=\"line\">      <span class=\"attr\">failedLoadingInfo</span>: <span class=\"string\">'獲取用戶信息失敗'</span>,</span><br><span class=\"line\">      <span class=\"attr\">deleteConfirm</span>: <span class=\"string\">'即將刪除 ID:[#ID] 評論，是否繼續？'</span>,</span><br><span class=\"line\">      <span class=\"attr\">total</span>: <span class=\"string\">'共 [#TOTAL] 條評論'</span>,</span><br><span class=\"line\">      <span class=\"attr\">noComment</span>: <span class=\"string\">'暫無評論'</span>,</span><br><span class=\"line\">      <span class=\"attr\">up</span>: <span class=\"string\">'正序'</span>,</span><br><span class=\"line\">      <span class=\"attr\">down</span>: <span class=\"string\">'倒序'</span>,</span><br><span class=\"line\">      <span class=\"attr\">delete</span>: <span class=\"string\">'刪除'</span>,</span><br><span class=\"line\">      <span class=\"attr\">top</span>: <span class=\"string\">'置頂'</span>,</span><br><span class=\"line\">      <span class=\"attr\">login</span>: <span class=\"string\">'登錄'</span>,</span><br><span class=\"line\">      <span class=\"attr\">required</span>: <span class=\"string\">'必填'</span>,</span><br><span class=\"line\">      <span class=\"attr\">optional</span>: <span class=\"string\">'選填'</span>,</span><br><span class=\"line\">      <span class=\"attr\">nickname</span>: <span class=\"string\">'暱稱'</span>,</span><br><span class=\"line\">      <span class=\"attr\">email</span>: <span class=\"string\">'郵箱'</span>,</span><br><span class=\"line\">      <span class=\"attr\">link</span>: <span class=\"string\">'網址'</span>,</span><br><span class=\"line\">      <span class=\"attr\">day</span>: {</span><br><span class=\"line\">      <span class=\"attr\">justNow</span>: <span class=\"string\">'剛剛'</span>,</span><br><span class=\"line\">      <span class=\"attr\">minute</span>: <span class=\"string\">'[#TIME] 分鐘前'</span>,</span><br><span class=\"line\">      <span class=\"attr\">hour</span>: <span class=\"string\">'[#TIME] 小時前'</span>,</span><br><span class=\"line\">      <span class=\"attr\">day</span>: <span class=\"string\">'[#TIME] 天前'</span>,</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br></pre></td></tr></tbody></table></figure><h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><p>Detalk.js 未来会与 ESHexoN 融合，在 ESHexoN 中提供管理面板。</p><p>同时，YFun's Blog 也会在后续更新有关 Detalk.js 的更多文章。</p><p>目前，此博客已经更换至 Detalk.js 评论系统，欢迎测试与使用！</p></div></div></div><div class=\"post-category\"><div id=\"p-meta-i\"><a class=\"hover-with-bg\" href=\"/categories/%E5%BC%80%E6%BA%90/\">开源</a> <a class=\"hover-with-bg\" href=\"/tags/%E8%AF%84%E8%AE%BA/\"># 评论</a> <a class=\"hover-with-bg\" href=\"/tags/%E5%BC%80%E6%BA%90/\"># 开源</a> <a class=\"hover-with-bg\" href=\"/tags/Detalk/\"># Detalk</a></div></div><div class=\"post-footer\"><div class=\"donate text-center\"><span>喜欢这篇文章？为什么不考虑打赏一下作者呢？</span><div class=\"donate-way\"><a target=\"_blank\" rel=\"noopener\" href=\"https://afdian.net/@ocoke\" class=\"donate-btn button\">爱发电 (跨年立减优惠)</a></div></div><div class=\"post-copyright\"><p style=\"margin:5px 0\">文章作者：<a href=\"/\">YFun (@oCoke)</a></p><p style=\"margin:5px 0\">文章链接：<a href=\"https://blog.yfun.top/posts/2023/detalkjs/\">https://blog.yfun.top/posts/2023/detalkjs/</a></p><p style=\"margin:5px 0\">版权声明：本博客所有文章除特别声明外，均采用 <a target=\"_blank\" href=\"https://creativecommons.org/licenses/by-sa/4.0/deed.zh\" rel=\"nofollow noopener noopener\">CC BY-SA 4.0 协议</a> ，转载请注明出处，谢谢。</p></div></div><div class=\"comments\"><div id=\"miracle-comments\"><div id=\"detalk\"><div style=\"width:100%;text-align:center;display:flex;justify-content:center;align-items:center\"><svg width=\"30px\" height=\"30px\" viewBox=\"0 0 66 66\" xmlns=\"http://www.w3.org/2000/svg\"><g><animateTransform attributeName=\"transform\" type=\"rotate\" values=\"0 33 33;270 33 33\" begin=\"0s\" dur=\"1.4s\" fill=\"freeze\" repeatCount=\"indefinite\"></animateTransform><circle fill=\"none\" stroke-width=\"6\" stroke-linecap=\"round\" cx=\"33\" cy=\"33\" r=\"30\" stroke-dasharray=\"187\" stroke-dashoffset=\"610\"><animate attributeName=\"stroke\" values=\"#4285F4;#DE3E35;#F7C223;#1B9A59;#4285F4\" begin=\"0s\" dur=\"5.6s\" fill=\"freeze\" repeatCount=\"indefinite\"></animate><animateTransform attributeName=\"transform\" type=\"rotate\" values=\"0 33 33;135 33 33;450 33 33\" begin=\"0s\" dur=\"1.4s\" fill=\"freeze\" repeatCount=\"indefinite\"></animateTransform><animate attributeName=\"stroke-dashoffset\" values=\"187;46.75;187\" begin=\"0s\" dur=\"1.4s\" fill=\"freeze\" repeatCount=\"indefinite\"></animate></circle></g></svg></div></div></div><style>.comment-title h3{font-size:1.25rem}.detalk-container .input-label label{width:30%!important}.detalk-container .input-data .input-area input{width:70%!important}</style></div></article></div><footer class=\"text-center\"><p style=\"display:flex;justify-content:center;align-items:center\">本网站由<a href=\"https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral\" target=\"_blank\" rel=\"nofollow noopener\">又拍云</a>提供 CDN 加速</p><script>let script=document.createElement(\"script\");script.src=\"https://ca.yfun.top/link.js?cache=all\",script.onload=()=>{console.log(\"[INFO] CKY Analytics Enabled!\"),push_load_data(),track_deploy()},script.async=!0,script.defer=!0,script.setAttribute(\"data-website-id\",\"c41870b7-71cc-46ea-b74b-73c60d0e3949\"),document.body.appendChild(script)</script><p>© 2020 - 2023&nbsp;&nbsp;YFun's Blog</p><p>Powered by <a href=\"https://hexo.io\" target=\"_blank\">Hexo</a> | Theme by <a href=\"https://github.com/oCoke/hexo-theme-miracle\" target=\"_blank\">Miracle</a></p></footer><div class=\"p-btn\"><a class=\"toc-btn\" id=\"toc-btn\"><i id=\"i-menu\"></i></a> <a class=\"toc-btn\" id=\"share-btn\"><i><svg t=\"1670124379155\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"2683\" width=\"25\" height=\"25\"><path d=\"M395.946667 234.666667v64H256v469.333333h512V522.666667h64V768a64 64 0 0 1-64 64H256a64 64 0 0 1-64-64V298.666667a64 64 0 0 1 64-64h139.946667z m335.850666-87.914667l150.848 150.826667-158.378666 158.4-45.269334-45.248L748.394667 341.333333H672c-121.685333 0-220.714667 97.024-223.914667 217.941334L448 565.333333v85.333334h-64v-85.333334C384 406.272 512.938667 277.333333 672 277.333333h99.861333l-85.312-85.333333 45.248-45.248z\" p-id=\"2684\" fill=\"var(--first-text-color)\"></path></svg> </i></a><a href=\"javascript:window.scrollTo({top:0,behavior:'smooth'});\" class=\"click-btn\"><i id=\"i-up\"></i></a></div><script>document.getElementById(\"btn-dropdown\").addEventListener(\"click\",()=>{toggleClass(\"#dropdown-menus\",\"display-inline\")}),console.log(\"\\n %c Powered by Hexo Theme Miracle  %c https://github.com/hifun-team/hexo-theme-miracle \\n\\n\",\"color: #fff; background: #4F9BFA; padding:5px 0;\",\"background: #FFF; padding:5px 0;\"),setTimeout(()=>{var e;15==(new Date).getHours()&&(e=document.createComment(\" 三点几嚟！饮茶先啦！ \"),document.body.insertBefore(e,document.getElementsByTagName(\"header\")[0]))},1)</script>"}